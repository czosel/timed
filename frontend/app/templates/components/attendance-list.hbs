<h2>Activities</h2>

<table class="table">
  <colgroup>
    <col>
    <col class="table-button-col">
  </colgroup>
  <tbody>
    <tr>
      <td class="b0">
        {{date-picker date=view.currentDay class='input-sm'}}
      </td>
      <td class="b0">
        {{! TODO: Get component actions right, this won't work without #if... }}
        {{#if view.user}}
          <button {{action 'openModal' 'attendance' view.currentDay}} class="btn btn-sm btn-default tip" title="Add attendance">
            <span class="glyphicon glyphicon-plus"></span>
          </button>
        {{/if}}
      </td>
    </tr>
  </tbody>
</table>

{{#if view.attendances}}
  {{#each attendance in view.attendances}}
    <table class="table">
      <colgroup>
        <col>
        <col>
        <col>
        <col class="table-button-col">
        <col class="table-button-col">
      </colgroup>
      <thead>
        <tr>
          <th colspan="3">
            {{date-format attendance.from 'hh:mm'}} {{date-format attendance.to '- hh:mm'}}
          </th>
          <th>
            <button {{action 'openModal' 'activity' attendance}} class="btn btn-sm btn-default tip" title="Add activity">
              <span class="glyphicon glyphicon-plus"></span>
            </button>
          </th>
          <th>
            <button {{action 'openModal' 'attendance' attendance}} class="btn btn-sm btn-default tip" title="Edit attendance">
              <span class="glyphicon glyphicon-edit"></span>
            </button>
          </th>
        </tr>
        <tr>
          <th>Project</th>
          <th>Task</th>
          <th colspan="2" class="tar">Duration</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {{#each activity in attendance.activities}}
          <tr>
            <td>
              <small>
                {{activity.task.project.customer.name}}
                <br>
                {{activity.task.project.name}}
              </small>
            </td>
            <td>{{activity.task.name}}</td>
            <td class="tar" colspan="2">
              {{date-duration activity.from activity.to}}
            </td>
            <td>
              <button {{action 'openModal' 'activity' activity}} class="btn btn-sm btn-default tip" title="Edit activity">
                <span class="glyphicon glyphicon-edit"></span>
              </button>
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{/each}}
{{/if}}
